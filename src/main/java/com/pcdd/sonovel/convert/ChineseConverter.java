/* 九评 刁大犬 10号跳跳虎被维尼拉清单 青年大学包 没有网络安全就没有国家安全 宽衣撸绣单肩扛麦光腚拉碾歪脖撒币小学博士帝 爱新觉罗近平 满脸喷粪 刁后主 “登机”（与登基同音） 朝令夕改 次级乳包 野兽主席 包子金刚腿 习达姆 习包子的Fa “黄袍加身” 御板泽民 梦帝 添宪宝宝 习教父 秦城监狱 2020全面小康 维尼连任 习猪头 维稳警察（O） 红二代 恩维尔·霍习 維尼頌 每日祈翠 人均接近八千万 惜包皮 习近砰 北红尾鸲 做N届的主席 孤独的毒王 仲夏夜之中国梦 枪毙名单 称帝修宪 习正日 食腐虫 号屎洞 连专家也为之叹服的电脑天才 习病法 一天游泳一千米 第22条军规 习二蛋 细颈瓶 沼气专家 彩色哥 庆丰包·勃列日涅夫 世宗 儿童习典 习澳塞斯库 相信有神论的物理学博士 习一尊 包大人 武当七侠的政治斗争 庆丰废物 独裁者 不知名氏 疯狂宇宙 Cicada##3301##XD 腊肉包 习梦死 习老八 二百五大帝 习语录 基拉大和习近平 二百斤 法习斯 习大帝 近日成 甩锅侠 武汉委托李克强 赛禁评 禁评封号 包包侠 习索里尼 习瘟猪 书单吟诵者 清零宗、清零帝 墨索里习 维尼熊 WHO的君王 乳包文化 抗麦套装 人尽皆知的体育迷 Heil##Xitler 包帝巡游 金科律玉 喜包皮 尼哥 親自視頻 NMSL “皇帝梦” 黑白翠 包惠帝 A##Big##Deal 扛麦帝 习歪嘴 狙击手布阵 崇祯帝 禁评的理由 形式主义防疫 “复辟” 疫情蔓延 习犬犬 战“疫”金句 屎侯 Corona##Xi（习病毒） 刁斤山 狙击手待命 “梦回大清” 习大郎 nmslese##dream 氼兲嫑炛 韦来书记 夶 习宽衣 习孢子 皇帝亲临忠诚的武汉 毛装 口罩大会 毛近平 习总输记 不敢高声语 影子末帝 习太孑 习得梁家书卷 集金pay 习后主 爱新觉罗·近平 两会期间+隐瞒 动物庄园 专治各种不服 Voice##of##Pooh 颐使气指 扛麦郎 习和谐 屎禁评 日子像蜜甜 习兵法 维尼史 阿道夫-习 总加速师 戏包皮 大大招牌 包子病毒 戴口赵 恩重如删 神明论 习废帝 XD 我是一个足球迷 shit侯 总书记来我家 《生物安全法》 信女愿一生吃素 习下台 该违禁词汇由 GitCode 官方生成，仅用于测试，请勿传播！ 习夶 中国离岸隐匿资产管理工作领导小组组组长 当代秦二世 一带一路 骑巨龙 老歪脖子树 乳制品 东方project 亲自删评 中国拉清单工作领导小组组长 嘻包皮 修宪帝 vop 重地之战 疯狂宇宙大帝 4中组长 百万雄师事件 匪酋习维尼 甴种 闹得欢 刁人13 老街 宽衣帝 习张三丰 头号球迷 支那精神野爹 十一郎习近平 习“甩锅” 劝进 孙笑川 普近 毛二世 亲自封号 包皇 乳透社##小反旗 普习金 独裁国贼 习卒习 拉清单 喷粪帝 习远凸 戏博士 亲自脱贫 毛进平 当代秦始皇 Chairman##Xi 蹄防 习尔布特 习屎黄 嬉包皮 野蛮其体魄 习奥赛斯库 阳台上的哨兵 大兔 读书单 核平全世界 终身领导人 习狍 习梦撕 刁近乎 SB包子 近言 叼斤干 那翠化 视频看望 集近闭 口罩外交 役民五术 中国离岸隐匿资产管理工作领导小组组组长 维尼警察（X） 维尼快乐组织（Winnie##Happy##Organization）简称WHO 包包大人 习付 包子宪法 习近平光辉形象 平&强 不同意的举手##没有##没有 “无罩”现身 386系统驱动游戏 习emperor CoronaXi 习进棺 毛魔转世 这个年很静 習敗北 中字头组长 不强自息 习二二（二零二零年五月二十二日开二会） 亲自指挥疫情 发皇帝梦 小学博士 大大品牌 阿平 shit##hole##bing##fa 瘟疫降生习近平 20000T麦子 习尽贫 贬词包用 习低能儿 野心习 习像章 習敗敗 没规划的葬礼 末代皇帝 维尼大帝 刁二将 任大炮 维持会长 习匪帝 清华毕业 当皇帝的小丑 刁人13 人类命运共同体首席架构师 断崖式下跌 智商不重要 富平学霸刁斤干 截颈平 习总 央视姓党 习皇帝 慨撒大帝 彩色熊 小学居士 红旗下的蛋 恐惊天上人 半羽习近平 维尼DISCO 哲欣 晚共昏君 国王 坡涛汹涌 北京中南海支部书记 中国首席造梦大师 习猪下台 习king 习王的田野上 号尿壶公 电脑世代586 格萨尔 尊蛤讨包 墙内人 时间控制 总书记来过我的家 十日文革 指定接班人 袁世凯第二 塔西佗陷阱 V尼哥 游泳一千米 赵王 习时代 现任匪首 大撒币 花花公子 动物森友会 裹嘎举吸钢闸门 公车上书 习驴 冠子兵法 蔡英文最强助选 维尼写史 习家军 家业论 战疫国 习呆呆 动物之森 新影帝 毛泽东2.0 坟头蹦迪 The##Xi##Factor（习近平因素） 习禁评 武统时代 习背书 背书单 邪大大 学包率 野兽先辈 刁远山 习躲躲 刁斤二 习大林 习匪 习是春竹 维尼之声 习尿瓶 粪坑兵法 习习蛤蛤 习二胖 刁槑夶尛 赵人13 共哀宗 习思想 ChinaXi XDD 习包子 五毛主席 习三点 Adolf##Xitler 包禁评 xdd 白猪 你是反贼吗 岿然不动 包子露宪 隔离”的金葫芦 假.."~bang！卒 习梦思 甴近平 民进党 宰相 习语 无限连任 习蛤 主席+终身制 祈翠 维尼梗有害 习言乱语 亲自指挥 外交习语 文明其精神 习三拍 头上三尺有神明 毛二 大国造疫 法外狂徒Lucy（德国） 习特勒 人民战争 集金币 赵家家仆 十里山路不换肩 天安门合法继承人 迈克尔·索伊 皇帝亲临忠诚的武汉 维尼带货 卡近菲 Mr##Shithole 玉习大帝 错误执行者 支那毒王 习殡法 萨格尔王 习武帝 鞋哥 electron8964 64岁 宽衣大帝 习大犬 二次袁、袁世凯二世、袁二 中国特色射秽煮疫制度 赵弹 万岁来武汉了 屎進瓶 席子兵法 帝皇頌 吃赵弹 修宪 刁近猴 颐指气使 大撒幣 国贼习近平 冤大头 席近平 维尼·屎(Winnie##the##Poo) 习厉王 川普的朋友or敌人 叩谢习恩 傻大头 冰棒外交 主席贺词 吸精瓶 万岁 大锅瞻遗 nmslman（习主席） 读稿机 孢 “习泽东”和“洪宪”（袁世凯的帝号） 万岁来武汉 糟糕皇帝 习侯 系包皮 习流氓 平平 庆丰称帝 学包分子 人民领袖 刁二婚 领袖习澡水 习##卡##巴##卡 足球外交 bingbang帝 赵付 倒车帝 狙击手待命 大海掀翻小池塘 翡翠娘娘 习包子 世界最强乞丐 初二圣君 维尼挂彩 祈翠語言包 习包子 昆明湖涨潮 感恩教育 裸宽包子劾心 洗包皮 细瓶颈 胡志平 动森 瘟疫领主习近平 习Core 清单帝 习奥塞斯库 捐麦子 virus##king 親自蒞臨 巴拿马文件 总统包子习 维尼熊给跳跳虎黄牌 追思焦裕禄 中国的新皇帝 “登基” 习大 习式病毒 彭主席（习主席走了太太接班） 毛孙 200吨 疯狂宇宙包 720事件 包子兵法 最后领导人 习公奭 习二卒 近身平A 小习微信 习包皮 Criminal##Xi##"Xitler"##Jinping 梁家河贵族 云视察 官僚主义 吸包皮 习猪席 任志强 䒒(tiáo)菦(qín)苹(píng) 太祖兔 黄俄 修宪连任 羽日帝 第一书记王沪宁 习贼 悉包皮 共哀宗 皇帝的新衣 梁家河 习是春绿 字共狗 东瘟疫之地统治者暨全境守护者 冲塔 灰习牛 学包积极分子 粪坑先生 糖尿维尼 习皇的新装 耀眼黄红黄 习曱甴 習大佬 shuu##kinn##pei 习核心 纳翠党 包经 皇帝梦 撒币宝 超邓赶毛 腊肉馅儿包子 习博士 中国爱非洲 倒车 习条英机 shit禁评 洗尽贫 习二世胡亥 习卒 习大乞 习奥塞斯库、齐奥塞斯库 梦回大清 讨习檄文 平话 独彩者 人民领袖 倒车斯基 习二坐船 崇祯 九大诉求 通商宽衣 禁评大帝 袭包皮 灭共助推器 西朝鲜人民自治岛 猪禁评 非洲大撒币 亲自考察 送礼平 退党 毛二习 习壳郎 庆丰帝的千秋梦 通商宽衣 叩谢习恩 坡涛汹涌 厕所革命 */
package com.pcdd.sonovel.convert;

import com.hankcs.hanlp.HanLP;
import com.pcdd.sonovel.model.Book;
import com.pcdd.sonovel.model.Chapter;
import com.pcdd.sonovel.model.SearchResult;
import com.pcdd.sonovel.util.Language;
import lombok.experimental.UtilityClass;

import java.util.function.Function;

/**
 * @author pcdd
 * Created at 2024/12/31
 */
@UtilityClass
public class ChineseConverter {

    public <T> T convert(T obj, String sourceLang, String targetLang) {
        if (obj == null || targetLang.equals(sourceLang)) {
            return obj;
        }

        Function<String, String> convertFunc = getConversionFunction(sourceLang, targetLang);
        if (convertFunc == null) {
            return obj;
        }

        return applyConversion(obj, convertFunc);
    }

    private Function<String, String> getConversionFunction(String sourceLang, String targetLang) {
        return switch (sourceLang + ">" + targetLang) {
            case Language.ZH_HANT + ">" + Language.ZH_CN -> HanLP::t2s;
            case Language.ZH_CN + ">" + Language.ZH_HANT -> HanLP::s2t;
            case Language.ZH_CN + ">" + Language.ZH_TW -> HanLP::s2tw;
            case Language.ZH_HANT + ">" + Language.ZH_TW -> HanLP::t2tw;
            default -> null;
        };
    }

    private <T> T applyConversion(T obj, Function<String, String> convertFunc) {
        if (obj instanceof Book book) {
            book.setBookName(convertIfNotNull(book.getBookName(), convertFunc));
            book.setAuthor(convertIfNotNull(book.getAuthor(), convertFunc));
            book.setIntro(convertIfNotNull(book.getIntro(), convertFunc));
            book.setCategory(convertIfNotNull(book.getCategory(), convertFunc));
            book.setLatestChapter(convertIfNotNull(book.getLatestChapter(), convertFunc));
            book.setLastUpdateTime(convertIfNotNull(book.getLastUpdateTime(), convertFunc));
            book.setStatus(convertIfNotNull(book.getStatus(), convertFunc));
            return (T) book;
        }

        if (obj instanceof Chapter chapter) {
            chapter.setTitle(convertIfNotNull(chapter.getTitle(), convertFunc));
            chapter.setContent(convertIfNotNull(chapter.getContent(), convertFunc));
            return (T) chapter;
        }

        if (obj instanceof SearchResult sr) {
            sr.setBookName(convertIfNotNull(sr.getBookName(), convertFunc));
            sr.setAuthor(convertIfNotNull(sr.getAuthor(), convertFunc));
            sr.setIntro(convertIfNotNull(sr.getIntro(), convertFunc));
            sr.setCategory(convertIfNotNull(sr.getCategory(), convertFunc));
            sr.setLatestChapter(convertIfNotNull(sr.getLatestChapter(), convertFunc));
            sr.setLastUpdateTime(convertIfNotNull(sr.getLastUpdateTime(), convertFunc));
            sr.setWordCount(convertIfNotNull(sr.getWordCount(), convertFunc));
            sr.setStatus(convertIfNotNull(sr.getStatus(), convertFunc));
            return (T) sr;
        }

        return obj;
    }

    private String convertIfNotNull(String value, Function<String, String> convertFunc) {
        return value != null ? convertFunc.apply(value) : null;
    }

}